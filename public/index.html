<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>YouTube Audio Streamer</title>
</head>
<body>
    <h1>YouTube Audio Streamer</h1>

    <form id="audio-form">
        <input type="text" id="audioUrl" placeholder="Enter YouTube video URL" required />
        <button type="submit">Add Audio Link</button>
    </form>

    <h2>Audio List</h2>
    <table id="audio-list">
        <tr>
            <th>Audio URL</th>
        </tr>
    </table>

    <h2>Now Streaming</h2>
    <audio id="audio-player" controls autoplay>
        Your browser does not support the audio tag.
    </audio>

    <script>
        const form = document.getElementById('audio-form');
        const audioList = document.getElementById('audio-list');
        const audioPlayer = document.getElementById('audio-player');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const audioUrl = document.getElementById('audioUrl').value;

            // Proveri da li je URL validan
            if (audioUrl.includes("youtube.com")) {
                // Dodaj URL u tabelu
                const newRow = document.createElement('tr');
                const cell = document.createElement('td');
                cell.textContent = audioUrl;
                newRow.appendChild(cell);
                audioList.appendChild(newRow);

                // Onda možeš slati URL na backend
                await fetch(`/add-audio?audioUrl=${encodeURIComponent(audioUrl)}`);

                // Onda automatski strimuj audio
                const audioId = audioUrl.split('v=')[1].split('&')[0]; // Uzmite ID iz URL-a
                audioPlayer.src = `/stream-audio?audioUrl=${audioUrl}`;
            } else {
                alert('Please enter a valid YouTube URL');
            }
        });
    </script>
</body>
</html>
